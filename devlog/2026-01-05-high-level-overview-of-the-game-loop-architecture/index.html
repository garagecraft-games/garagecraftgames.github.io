<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-devlog" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">helios - A High-Level Overview of the Game Loop Architecture | garagecraft.games</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://garagecraft.games/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://garagecraft.games/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://garagecraft.games/devlog/2026-01-05-high-level-overview-of-the-game-loop-architecture/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="helios - A High-Level Overview of the Game Loop Architecture | garagecraft.games"><meta data-rh="true" name="description" content="A deep dive into the architectural separation of concerns in helios. This post outlines how deterministic world mutations are handled via bare-metal Commands and Managers, while decoupled communication relies on a mix of double-buffered and immediate Event Buses to ensure both thread safety and low-latency feedback."><meta data-rh="true" property="og:description" content="A deep dive into the architectural separation of concerns in helios. This post outlines how deterministic world mutations are handled via bare-metal Commands and Managers, while decoupled communication relies on a mix of double-buffered and immediate Event Buses to ensure both thread safety and low-latency feedback."><meta data-rh="true" name="keywords" content="cpp,game engine,architecture,command pattern,event bus,immediate mode,batch processing,determinism,frame lifecycle"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2026-01-05T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://thorsten.suckow-homberg.de"><meta data-rh="true" property="article:tag" content="DevLog,helios,architecture,game-loop,events,commands,double-buffering,data-oriented-design"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://garagecraft.games/devlog/2026-01-05-high-level-overview-of-the-game-loop-architecture/"><link data-rh="true" rel="alternate" href="https://garagecraft.games/devlog/2026-01-05-high-level-overview-of-the-game-loop-architecture/" hreflang="en"><link data-rh="true" rel="alternate" href="https://garagecraft.games/devlog/2026-01-05-high-level-overview-of-the-game-loop-architecture/" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://garagecraft.games/devlog/2026-01-05-high-level-overview-of-the-game-loop-architecture/","mainEntityOfPage":"https://garagecraft.games/devlog/2026-01-05-high-level-overview-of-the-game-loop-architecture/","url":"https://garagecraft.games/devlog/2026-01-05-high-level-overview-of-the-game-loop-architecture/","headline":"helios - A High-Level Overview of the Game Loop Architecture","name":"helios - A High-Level Overview of the Game Loop Architecture","description":"A deep dive into the architectural separation of concerns in helios. This post outlines how deterministic world mutations are handled via bare-metal Commands and Managers, while decoupled communication relies on a mix of double-buffered and immediate Event Buses to ensure both thread safety and low-latency feedback.","datePublished":"2026-01-05T00:00:00.000Z","author":{"@type":"Person","name":"Thorsten Suckow-Homberg","url":"https://thorsten.suckow-homberg.de","image":"https://avatars.githubusercontent.com/u/823135"},"keywords":["cpp","game engine","architecture","command pattern","event bus","immediate mode","batch processing","determinism","frame lifecycle"],"isPartOf":{"@type":"Blog","@id":"https://garagecraft.games/devlog","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/devlog/rss.xml" title="garagecraft.games RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/devlog/atom.xml" title="garagecraft.games Atom Feed"><link rel="stylesheet" href="/assets/css/styles.098ad6cf.css">
<script src="/assets/js/runtime~main.a92d97dc.js" defer="defer"></script>
<script src="/assets/js/main.e92ba3e4.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="dark";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/home.svg"><link rel="preload" as="image" href="https://avatars.githubusercontent.com/u/823135"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/home.svg" alt="Home" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/home.svg" alt="Home" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a class="navbar__item navbar__link" href="/helios">helios</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/devlog">devlog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/garagecraft-games" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link"></a><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">All posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2026</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/devlog/2026-01-05-high-level-overview-of-the-game-loop-architecture/">helios - A High-Level Overview of the Game Loop Architecture</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2025</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/devlog/devlog/2025-12-31-enemy-spawn-system/">New Year‚Äôs Eve, New Spawn System</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/devlog/2025/12/25/milestone3-release">üéÑ Milestone 3: Game Systems, Components, Projectiles and Boundaries üéÅ</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/devlog/2025/12/16/milestone2-release">Milestone 2: Scene Graph, Gamepad Widgets, and a Flying Spaceship</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/devlog/2025/12/04/imgui-integration-and-breaking-changes">ImGui Integration and Breaking Changes</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/devlog/2025/11/25/value-driven-game-development-in-the-age-of -aI-assistance">AI Assistance in Game Development</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/devlog/2025/11/10/helios-design-and-prototypical-implementation-of-a-cpp-game-framework">helios: Design and prototypical implementation of a C++ game framework</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/devlog/2025/10/19/just-make-it-exist-first">Just make it exist first</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/devlog/2025/09/28/onwards-to-the-rendering-model">Onwards to the rendering model</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/devlog/2025/09/22/from-eventqueue-to-app-controller">Event Queue and Application Controllers</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/devlog/2025/09/17/orthographic-and-perspective-projection">From Camera- to Clip-Space, to NDCs and z-Fighting</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/devlog/2025/09/14/updates-to-main">Updates to main()</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/devlog/2025/09/13/the-great-modular-restructuring">The Great Modular Restructuring</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/devlog/2025/09/07/layer-abstraction has-begun">Layer Abstraction initiated</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/devlog/2025/09/05/inbefore-clipspace">Inb4 Clip Space</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/devlog/2025/09/02/model-matrix-rotations">Model Matrix: Rotations</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/devlog/2025/08/31/establishing-the-transformation-library">Establishing the Transformation Library</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/devlog/2025/08/26/model-matrix-transformations">Model Matrix: Transformations</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/devlog/2025/08/23/cmake-has-entered-the-chat">CMake has entered the chat</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/devlog/2025/08/17/helios-engine-foundation">Sundays are for constexpr</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/devlog/2025/08/16/lost-in-translation">Lost in Translation</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/devlog/2025/08/15/hello-world">Hello World</a></li></ul></div></nav></aside><main class="col col--7"><article class=""><header><h1 class="title_f1Hy">helios - A High-Level Overview of the Game Loop Architecture</h1><div class="container_mt6G margin-vert--md"><time datetime="2026-01-05T00:00:00.000Z">January 5, 2026</time> ¬∑ <!-- -->6 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://thorsten.suckow-homberg.de" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://avatars.githubusercontent.com/u/823135" alt="Thorsten Suckow-Homberg"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://thorsten.suckow-homberg.de" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp">Thorsten Suckow-Homberg</span></a></div><div class="authorSocials_rSDt"></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p>Over the past few weeks, I‚Äôve been busy refining the helios GameLoop to enable player interactions with various GameObjects. This included, in particular, controlling the player ship, spawning enemies, and - the holy grail of every game - the collision system.</p>
<p>It quickly became apparent that a purely object-oriented approach was too brittle and inflexible, leaving me no choice but to read up on a more versatile approach: the component-based system. For me, as an OOP scholar, this meant a paradigm shift in how I design software - but it was worth it.</p>
<p>And I‚Äôve come to feel strongly that academic teaching places far too much emphasis on OOP.</p>
<p>Even though I am only scratching the surface of proper ECS in this prototype phase, I am very satisfied with the result. However, the problem remained of how to communicate and process cross-frame actions - who orchestrates the spawning? What is a spawn, anyway? Is it an Event? Is it a Command?</p>
<p>Based on the collision system, I had to turn the architectural screw a little further - resulting in the following design, which I will be pouring into the framework over the coming weeks.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="high-level-overview-of-the-game-loop-architecture">High-Level Overview of the Game Loop Architecture<a href="#high-level-overview-of-the-game-loop-architecture" class="hash-link" aria-label="Direct link to High-Level Overview of the Game Loop Architecture" title="Direct link to High-Level Overview of the Game Loop Architecture">‚Äã</a></h2>
<div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">[english]</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">[deutsch]</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><p>helios distinguishes between <strong>Commands</strong> (world-mutating operations) and <strong>Events</strong> (signals/facts).
Commands exist to mutate the world state <em>deterministically</em>. Events exist to decouple systems: they either express a request/intent (e.g. SpawnRequest) or a fact (e.g. <code>SolidCollisionEvent</code>, <code>TriggerCollisionEvent</code>, <code>SpawnedEvent</code>).</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="commands-and-commandbuffer">Commands and CommandBuffer<a href="#commands-and-commandbuffer" class="hash-link" aria-label="Direct link to Commands and CommandBuffer" title="Direct link to Commands and CommandBuffer">‚Äã</a></h2><p>Participating systems can write Commands into the CommandBuffer in frame $N$.
At the beginning of each frame $N+1$, the CommandBuffer is flushed, which commits the Commands - i.e. their <code>execute()</code> method is invoked. This method contains the logic that mutates the world state (e.g. spawning, despawning, health changes, component changes). Commands are <code>bare metal</code> and therefore the lowest level in the game-loop layer, i.e. no further preparation of a Command is required. The system should therefore also be able to commit Commands coming directly from a developer console into the GameWorld (optionally delegating them to their respective managers - see below).</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="events-and-double-buffered-eventbus">Events and double-buffered EventBus<a href="#events-and-double-buffered-eventbus" class="hash-link" aria-label="Direct link to Events and double-buffered EventBus" title="Direct link to Events and double-buffered EventBus">‚Äã</a></h2><p>In addition, systems can emit Events in frame $N$, e.g. <strong>request events</strong> - events that intend to mutate the world state - or plain signals such as <code>SolidCollisionEvent</code>, from which world-mutating Commands (despawn) can be derived.
The EventBus is double-buffered (<code>helios.core.data.TypeIndexedDoubleBuffer</code>): events are written into the write buffer in frame $N$ and become visible in the read buffer only after a buffer swap (<code>swapBuffers()</code>) at the beginning of frame $N+1$.</p><p>At the beginning of frame $N+1$, events are dispatched from the read buffer. As mentioned above, request events can be translated into Commands and written into the CommandBuffer.</p><p>This yields the following order at the beginning of frame $N+1$:</p><div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">EventBus</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">swapBuffers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">EventBus</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">dispatch</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// Events from which Commands may be generated</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">CommandBuffer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">flush</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// Commit - mutates the world state,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                      </span><span class="token comment" style="color:rgb(98, 114, 164)">// optional manager-based command processing</span><br></span></code></pre></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="optional-manager-based-command-processing">Optional manager-based command processing<a href="#optional-manager-based-command-processing" class="hash-link" aria-label="Direct link to Optional manager-based command processing" title="Direct link to Optional manager-based command processing">‚Äã</a></h3><p>Instead of having each Command fully implement the mutation logic in <code>execute()</code>, the CommandBuffer can additionally hold registered managers. In this model, <code>execute()</code> primarily performs a registering/planning step, and the managers then process their work as a coordinated batch.</p><p>Example:</p><div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token class-name">CommandBuffer</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token function" style="color:rgb(80, 250, 123)">flush</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">auto</span><span class="token operator">&amp;</span><span class="token plain"> cmd </span><span class="token operator">:</span><span class="token plain"> commands</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        cmd</span><span class="token operator">-&gt;</span><span class="token function" style="color:rgb(80, 250, 123)">execute</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain">   </span><span class="token comment" style="color:rgb(98, 114, 164)">// in execute e.g.:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                          </span><span class="token comment" style="color:rgb(98, 114, 164)">// spawnManager-&gt;enqueue(position, enemyType);</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">auto</span><span class="token operator">&amp;</span><span class="token plain"> mgr </span><span class="token operator">:</span><span class="token plain"> managers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        mgr</span><span class="token operator">-&gt;</span><span class="token function" style="color:rgb(80, 250, 123)">process</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain">   </span><span class="token comment" style="color:rgb(98, 114, 164)">// the spawnManager processes the spawn list</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre></div></div><p>This model allows Commands to be bundled, sorted, and processed deterministically (e.g. handle all spawns first, then all despawns).</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="immediate-events-single-buffered">Immediate Events (single-buffered)<a href="#immediate-events-single-buffered" class="hash-link" aria-label="Direct link to Immediate Events (single-buffered)" title="Direct link to Immediate Events (single-buffered)">‚Äã</a></h2><p>For time-critical feedback that does not mutate the world state (particle effects, audio feedback), there is a separate <strong>ImmediateBus</strong> (single-buffered).
Immediate events should be processed within the same frame without additional double-buffer latency. A suitable dispatch point is after <code>CommandBuffer.flush()</code>, so that feedback can observe the world that was committed at the beginning of the frame in a consistent state. This mitigates latency (e.g. ~16ms at 60fps) and allows feedback to be triggered in the same frame as a specific event, which improves the overall user experience (&quot;game feel&quot;).</p><p>Overall, the frame-begin order becomes:</p><div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">EventBus</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">swapBuffers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// input</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">EventBus</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">dispatch</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">CommandBuffer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">flush</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// mutation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ImmediateBus</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">dispatch</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// signals</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// gameplay systems updating physics</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Move2DSystem</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">update</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><br></span></code></pre></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><p>helios unterscheidet zwischen <strong>Commands</strong> (weltver√§ndernde Mutationen) und <strong>Events</strong> (Signale/Fakten).
Commands dienen dazu, den Weltzustand <em>deterministisch</em> zu ver√§ndern. Events dienen dazu, Systeme zu entkoppeln: Sie dr√ºcken entweder einen Request/Intent (z. B. SpawnRequest) oder ein Fakt (z. B. <code>SolidCollisionEvent</code>, <code>TriggerCollisionEvent</code>, <code>SpawnedEvent</code>) aus.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="commands-und-commandbuffer">Commands und CommandBuffer<a href="#commands-und-commandbuffer" class="hash-link" aria-label="Direct link to Commands und CommandBuffer" title="Direct link to Commands und CommandBuffer">‚Äã</a></h2><p>Teilnehmende Systeme k√∂nnen beliebig Commands in Frame $N$ in den CommandBuffer schreiben.
Zu Beginn jedes Frames $N+1$ wird der CommandBuffer geflusht, wodurch die Commands committed werden  - es wird deren <code>execute()</code>-Methode aufgerufen. Die Methode enth√§lt die Logik, die den Weltzustand mutiert (z. B. Spawning, Despawning, Health-√Ñnderungen, Component-√Ñnderungen). Commands sind<code>bare metal</code> und damit die niedrigste Ebene in der GameLoop-Schicht, d.h., es ist keine weitere Aufbereitung eines Commands mehr n√∂tig. Das System sollte also auch in der Lage sein, Commands von einer Entwickler-Console direkt in die GameWorld zu √ºbertragen (ggf. an ihre entsprechenden Manager - s.u.).</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="events-und-double-buffered-eventbus">Events und Double-Buffered EventBus<a href="#events-und-double-buffered-eventbus" class="hash-link" aria-label="Direct link to Events und Double-Buffered EventBus" title="Direct link to Events und Double-Buffered EventBus">‚Äã</a></h2><p>Zus√§tzlich k√∂nnen Systeme in Frame $N$ Events erzeugen, z. B. <strong>Request Events</strong> - solche bspw. die beabsichtigen, einen den Weltzusatend zu mutieren, oder auch einfach nur Signale, wie bspw. <code>SolidCollisionEvent</code>, aus der weltzustandmutierende Commands (despawn) abgeleitet werden.
Der EventBus ist double-buffered (<code>helios.core.data.TypeIndexedDoubleBuffer</code>): Events werden in Frame $N$ in den Write-Buffer geschrieben und sind erst nach einem Buffer-Swap (<code>swapBuffers()</code>) zu Beginn von Frame $N+1$ im Read-Buffer sichtbar.</p><p>Zu Beginn von Frame N+1 werden die Events aus dem Read-Buffer dispatcht; wie oben bereits erw√§hnt, k√∂nnen dabei aus Request-Events wiederum Commands generiert und in den CommandBuffer geschrieben werden.</p><p>Daraus ergibt sich zu Beginn von Frame $N+1$ die Reihenfolge:</p><div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">EventBus</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">swapBuffers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">EventBus</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">dispatch</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// Events, aus denen ggf. wiederum Commands erzeugt werden</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">CommandBuffer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">flush</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// Commit - mutiert den Weltzustand,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                      </span><span class="token comment" style="color:rgb(98, 114, 164)">// optionale Manager-basierte Command-Verarbeitung</span><br></span></code></pre></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="optionale-manager-basierte-command-verarbeitung">Optionale Manager-basierte Command-Verarbeitung<a href="#optionale-manager-basierte-command-verarbeitung" class="hash-link" aria-label="Direct link to Optionale Manager-basierte Command-Verarbeitung" title="Direct link to Optionale Manager-basierte Command-Verarbeitung">‚Äã</a></h3><p>Statt dass jeder Command die Logik einer Mutation vollst√§ndig in <code>execute()</code> implementiert, kann der CommandBuffer zus√§tzlich registrierte Manager besitzen. In diesem Modell f√ºhren Commands in <code>execute()</code> prim√§r eine registrierende/planende Aktion aus, und die Manager f√ºhren anschlie√üend ihre Arbeit koordiniert als Batch aus.</p><p>Beispiel:</p><div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token class-name">CommandBuffer</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token function" style="color:rgb(80, 250, 123)">flush</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">auto</span><span class="token operator">&amp;</span><span class="token plain"> cmd </span><span class="token operator">:</span><span class="token plain"> commands</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        cmd</span><span class="token operator">-&gt;</span><span class="token function" style="color:rgb(80, 250, 123)">execute</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain">   </span><span class="token comment" style="color:rgb(98, 114, 164)">// in execute bspw.:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                          </span><span class="token comment" style="color:rgb(98, 114, 164)">// spawnManager-&gt;enqueue(position, enemyType);</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">auto</span><span class="token operator">&amp;</span><span class="token plain"> mgr </span><span class="token operator">:</span><span class="token plain"> managers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        mgr</span><span class="token operator">-&gt;</span><span class="token function" style="color:rgb(80, 250, 123)">process</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain">   </span><span class="token comment" style="color:rgb(98, 114, 164)">// der spawnManager arbeitet die SpawnListe ab</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre></div></div><p>Dieses Modell erlaubt es, Commands zu b√ºndeln, zu sortieren und deterministisch abzuarbeiten (z. B. alle Spawns zusammen, dann alle Despawns).</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="immediate-events-single-buffered-1">Immediate Events (Single-Buffered)<a href="#immediate-events-single-buffered-1" class="hash-link" aria-label="Direct link to Immediate Events (Single-Buffered)" title="Direct link to Immediate Events (Single-Buffered)">‚Äã</a></h2><p>F√ºr zeitkritisches Feedback, das nicht den Weltzustand ver√§ndert (Partikeleffekte, Audio-Feedback) existiert ein separater <strong>ImmediateBus</strong> (single-buffered).
Immediate-Events sollen im selben Frame ohne zus√§tzliche Double-Buffer-Latenz verarbeitet werden. Ein geeigneter Dispatch-Punkt ist nach dem <code>CommandBuffer.flush()</code>, damit das Feedback die zu Beginn dieses Frames committete Welt konsistent sehen kann. Hierdurch kann Latenz mitigiert werden (bspw. 16ms bei 60fps) und Feedback kann noch im selben Frame zu einem bestimmten Ereignis gegeben werden, was das &quot;Game Feel&quot; verbessern kann.</p><p>Insgesamt ergibt sich damit zu Frame-Beginn:</p><div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">EventBus</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">swapBuffers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// input</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">EventBus</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">dispatch</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">CommandBuffer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">flush</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// Mutation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ImmediateBus</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">dispatch</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// Signale</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// gameplay systeme zur aktualisierung der physik</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Move2DSystem</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">update</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><br></span></code></pre></div></div></div></div></div></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" title="Development log entries documenting the journey of building helios and garagecraft games" class="tag_zVej tagRegular_sFm0" href="/devlog/tags/devlog">DevLog</a></li><li class="tag_QGVx"><a rel="tag" title="Posts about the helios C++23 game framework - architecture, implementation, and technical deep dives" class="tag_zVej tagRegular_sFm0" href="/devlog/tags/helios">helios</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/devlog/tags/architecture">architecture</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/devlog/tags/game-loop">game-loop</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/devlog/tags/events">events</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/devlog/tags/commands">commands</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/devlog/tags/double-buffering">double-buffering</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/devlog/tags/data-oriented-design">data-oriented-design</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--next" href="/devlog/devlog/2025-12-31-enemy-spawn-system/"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">New Year‚Äôs Eve, New Spawn System</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#high-level-overview-of-the-game-loop-architecture" class="table-of-contents__link toc-highlight">High-Level Overview of the Game Loop Architecture</a></li><li><a href="#commands-and-commandbuffer" class="table-of-contents__link toc-highlight">Commands and CommandBuffer</a></li><li><a href="#events-and-double-buffered-eventbus" class="table-of-contents__link toc-highlight">Events and double-buffered EventBus</a><ul><li><a href="#optional-manager-based-command-processing" class="table-of-contents__link toc-highlight">Optional manager-based command processing</a></li></ul></li><li><a href="#immediate-events-single-buffered" class="table-of-contents__link toc-highlight">Immediate Events (single-buffered)</a></li><li><a href="#commands-und-commandbuffer" class="table-of-contents__link toc-highlight">Commands und CommandBuffer</a></li><li><a href="#events-und-double-buffered-eventbus" class="table-of-contents__link toc-highlight">Events und Double-Buffered EventBus</a><ul><li><a href="#optionale-manager-basierte-command-verarbeitung" class="table-of-contents__link toc-highlight">Optionale Manager-basierte Command-Verarbeitung</a></li></ul></li><li><a href="#immediate-events-single-buffered-1" class="table-of-contents__link toc-highlight">Immediate Events (Single-Buffered)</a></li></ul></div></div></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">copyright ¬© 2026 <a href="#">GarageCraft Games</a> / <a href="https://thorsten.suckow-homberg.de">Thorsten Suckow-Homberg</a>.</div></div></div></footer></div>
</body>
</html>